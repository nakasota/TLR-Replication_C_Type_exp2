=== Fetching Proposal: MDU6SXNzdWU5OTU0MDc3Nzk= ===
Issue URL: https://github.com/golang/go/issues/48367

==== [Issue Title] ====
strings, bytes: deprecate Title

==== [Issue Body] ====
Packages `bytes` and `strings` define the method `Title`:
```Go
func Title(s []byte) []byte
func Title(s string) string
```

> [that] returns a copy with all Unicode letters that begin words mapped to their title case.

A known bug with this function is that it doesn't handle unicode punctuation properly (see https://github.com/golang/go/issues/6801). However, this can't be addressed due to the backwards compatibility guarantee, since it would change the function's output. This means that issues like https://github.com/golang/go/issues/34994 and https://github.com/golang/go/issues/48356 can't be addressed, which want Title to work around punctuation and emoji.

Furthermore, `Title` doesn't take into account language-specific capitalization rules. For example, the Dutch word `"ijsland"` should be capitalized as `"IJsland"`, but `Title` returns `"Ijsland"`.

A more robust alternative is `golang.org/x/text/cases`. Calling `cases.Title(<language>).Bytes(<bytes>)` or `cases.Title(<language>).String(<string>)` will deal with punctuation, different languages, and capitalize phrases.

Therefore, I propose deprecating `bytes.Title` and `strings.Title` in favor of `golang.org/x/text/cases`.

```Go
// Title treats s as UTF-8-encoded bytes and returns a copy with all Unicode letters that begin
// words mapped to their title case.
//
// BUG(rsc): The rule Title uses for word boundaries does not handle Unicode punctuation properly.
//
// Deprecated: Use golang.org/x/text/cases instead.
func Title(s []byte) []byte {
```
```Go
// Title returns a copy of the string s with all Unicode letters that begin words
// mapped to their Unicode title case.
//
// BUG(rsc): The rule Title uses for word boundaries does not handle Unicode punctuation properly.
//
// Deprecated: Use golang.org/x/text/cases instead.
func Title(s string) string {
```

==== [Comments] ====

--- Comment #1 by robpike ---
Not sure deprecation would do much. It's already got a big BUG annotation in the comment, and we can't get rid of it for compatibility reasons. But] pointing people to an actual bug-free replacement would be valuable.

--- Comment #2 by smasher164 ---
@robpike The reason for deprecation is three-fold:
1. `// Deprecated` comments are interpreted by tools like [staticcheck](https://staticcheck.io/docs/checks#SA1019) (and [eventually gopls](https://github.com/golang/go/issues/40447)) to discourage a function's use. pkg.go.dev even displays them differently:
![image](https://user-images.githubusercontent.com/12636891/133174300-795cdeb4-b6f2-4ab3-a383-93816abcd772.png)
2. It seems that issues related to `Title`'s output continue to be opened, and we aren't able to fix them due to the backwards compatibility promise. If we can't provide support for its implementation, and in the present of a more robust alternative, deprecation is the clear solution.
3. Deprecation notices are typically where alternatives are presented. If someone encounters `strings.Title` through an old example or tutorial, they now have a path forward.

--- Comment #3 by rsc ---
It seems OK to turn the BUG note into something tooling will expose more directly.
In retrospect it was a mistake to not have BUG comments be attached to specific functions/types/etc.


--- Comment #4 by rsc ---

This proposal has been added to the [active column](https://golang.org/s/proposal-status#active) of the proposals project
and will now be reviewed at the weekly proposal review meetings.
â€” rsc for the proposal review group


--- Comment #5 by smasher164 ---
> It seems OK to turn the BUG note into something tooling will expose more directly.

Is this for tools to be aware that a bug exists, or to provide some suggested action around it? If the suggested action is to replace the code with something else, I think deprecation notices already fulfill that purpose.

--- Comment #6 by rsc ---
By "It seems OK to turn the BUG note into something tooling will expose more directly."
I meant "it seems OK to replace the BUG note with a Deprecated: comment in this case."


--- Comment #7 by rsc ---

Based on the discussion above, this proposal seems like a **[likely accept](https://golang.org/s/proposal-status#likely-accept)**.
â€” rsc for the proposal review group


--- Comment #8 by andig ---
Iâ€˜m perfectly happy with using Title for cases where I know and control the source strings, e.g. for translating member variable visibility. Cases would be overkill for these scenarios. I also wouldnâ€˜t want the linter complain about me doing that. 

--- Comment #9 by smasher164 ---
> for cases where I know and control the source strings

So in this case, you
1. Are aware of `Title`'s limitations.
2. Understand that `Title`'s implementation falls under your use-case.
3. Have control over the source strings.

In the event that all three of these are true, I don't see the issue with using `//lint:ignore` to prevent the linter from flagging it.

Even if it weren't marked deprecated, users should still be made aware that there's a more robust/correct alternative for case mapping. And in that case, the situation wouldn't be much better than a linter warning.

> for translating member variable visibility

True, but `Title` is arguably also overkill here, since you only care about changing one rune.
```Go
func exported(s string) string {
	r, size := utf8.DecodeRuneInString(s)
	return string(unicode.ToTitle(r)) + s[size:]
}
```

--- Comment #10 by andig ---
> In the event that all three of these are true, I don't see the issue with using //lint:ignore to prevent the linter from flagging it.

My point is that there are perfectly valid uses of `Title` hence argue to not deprecate it. I'm unhappy with having to sprinkle my code with `//lint:ignore` for keeping  the linter happy.

--- Comment #11 by smasher164 ---
> My point is that there are perfectly valid uses of `Title` hence argue to not deprecate it. I'm unhappy with having to sprinkle my code with `//lint:ignore` for keeping the linter happy.

I'm curious about the perfectly valid use cases of `Title` that `cases` is overkill for, but also require examining more than one rune.

Also, if your linter were to suddenly warn you on `BUG` comments, would that also make you unhappy? Would you not want to know if a function you were using had bugs? In the case of `Title`, you are already aware of its limitations, but that may not extend across other functions or even other users.

And if needed, you could scope a lint directive to a function or file, and declare your own
```Go
func Title(s string) string {
    //lint:ignore SA1019 I know what I'm doing
    return strings.Title(s)
}
```

Would this resolve the issue with adding a linter directive all over the place?

--- Comment #12 by rsc ---

No change in consensus, so **[accepted](https://golang.org/s/proposal-status#accepted)**. ðŸŽ‰
This issue now tracks the work of implementing the proposal.
â€” rsc for the proposal review group

--- Content after FINAL acceptance decision removed ---