=== Fetching Proposal: I_kwDOAWBuf85E-bty ===
Issue URL: https://github.com/golang/go/issues/51428

==== [Issue Title] ====
net: make errCanceled and errTimeout be "errors.Is" context.Canceled and context.DeadlineExceeded

==== [Issue Body] ====

<!--
Please answer these questions before submitting your issue. Thanks!
-->

### What version of Go are you using (`go version`)?

<pre>
$ go version
go version go1.17.6 linux/amd64
</pre>

### Does this issue reproduce with the latest release?
Yes

### What operating system and processor architecture are you using (`go env`)?

<details><summary><code>go env</code> Output</summary><br><pre>
$ go env
GO111MODULE=""
GOARCH="amd64"
GOBIN=""
GOCACHE="/home/guenter.prossliner@world-direct.at/.cache/go-build"
GOENV="/home/guenter.prossliner@world-direct.at/.config/go/env"
GOEXE=""
GOEXPERIMENT=""
GOFLAGS=""
GOHOSTARCH="amd64"
GOHOSTOS="linux"
GOINSECURE=""
GOMODCACHE="/home/guenter.prossliner@world-direct.at/go/pkg/mod"
GONOPROXY=""
GONOSUMDB=""
GOOS="linux"
GOPATH="/home/guenter.prossliner@world-direct.at/go"
GOPRIVATE=""
GOPROXY="https://proxy.golang.org,direct"
GOROOT="/usr/local/go"
GOSUMDB="sum.golang.org"
GOTMPDIR=""
GOTOOLDIR="/usr/local/go/pkg/tool/linux_amd64"
GOVCS=""
GOVERSION="go1.17.6"
GCCGO="gccgo"
AR="ar"
CC="gcc"
CXX="g++"
CGO_ENABLED="1"
GOMOD="/home/guenter.prossliner@world-direct.at/proj/polly2/go.mod"
CGO_CFLAGS="-g -O2"
CGO_CPPFLAGS=""
CGO_CXXFLAGS="-g -O2"
CGO_FFLAGS="-g -O2"
CGO_LDFLAGS="-g -O2"
PKG_CONFIG="pkg-config"
GOGCCFLAGS="-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build117018826=/tmp/go-build -gno-record-gcc-switches"
</pre></details>

### What did you do?
This is part of a bigger application, but here is a repo: 
https://go.dev/play/p/mD-R6gerA4c

### What did you expect to see?

I expect that the net.OpErr which is returned by net.dialer.DialContext included the wrapped original error, which is a context.Canceled error.

This may be the problematic function. There is also a TODO from @bradfitz
https://github.com/golang/go/blob/40e24a942bce7b10e23a7282e673ac8a758ca378/src/net/net.go#L419-L434

### What did you see instead?
```
UNEXPECTED:dial tcp: operation was canceled
EXPECTED: Get "http://github.com": context canceled
```



==== [Comments] ====

--- Comment #1 by ianlancetaylor ---
This can be confusing but I don't see how to return `context.Canceled` without breaking existing applications.

One thing we can do is add an `Is` method to `net.errCanceled` that makes it match `context.Canceled`.  Then using `errors.Is(err, context.Canceled)` will return `true` for `net.errCanceled`, and I think that your program would work.  Similarly for `net.errTimeout`.  Does that seem useful?

--- Comment #2 by bcmills ---
Another option might be to give `net.errCanceled` an `Unwrap` method that returns `context.Canceled`, even though the `context.Canceled` error text does not appear in the `errCanceled` text.

It's not obvious to me whether that is better or worse than adding the `Is` method.

--- Comment #3 by gprossliner ---
Adding the `Is` function is probably the best option.

--- Comment #4 by ianlancetaylor ---
OK, I turned this into a proposal for the behavior change.

--- Comment #5 by rsc ---

This proposal has been added to the [active column](https://golang.org/s/proposal-status#active) of the proposals project
and will now be reviewed at the weekly proposal review meetings.
â€” rsc for the proposal review group


--- Comment #6 by rsc ---

Based on the discussion above, this proposal seems like a **[likely accept](https://golang.org/s/proposal-status#likely-accept)**.
â€” rsc for the proposal review group


--- Comment #7 by rsc ---

No change in consensus, so **[accepted](https://golang.org/s/proposal-status#accepted)**. ðŸŽ‰
This issue now tracks the work of implementing the proposal.
â€” rsc for the proposal review group

--- Content after FINAL acceptance decision removed ---