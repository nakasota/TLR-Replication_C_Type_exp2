=== Fetching Proposal: MDU6SXNzdWU5ODIzNDUzNTc= ===
Issue URL: https://github.com/golang/go/issues/48052

==== [Issue Title] ====
debug/plan9obj: add ErrNoSymbols sentinel for case that no symbol section exists

==== [Issue Body] ====
<!--
Please answer these questions before submitting your issue. Thanks!
For questions please use one of our forums: https://github.com/golang/go/wiki/Questions
-->

The elf package provide a sentinel error, [ErrNoSymbols](https://pkg.go.dev/debug/elf@go1.17#pkg-variables) for the case that Symbols or DynamicSymbols cannot return a symbol list because the section is empty. The same situation is handled in plan9obj by returning a [new error](https://cs.opensource.google/go/go/+/refs/tags/go1.17:src/debug/plan9obj/file.go;l=308) for this case. For PE/Mach-O there is no issue since access to the symbols is via direct access to a slice field.

Because of this, it's either necessary to do an error string comparison or re-call f.Section("syms") to check whether is was nil, repeating work that has already been done.

Originally posted to golan-nuts: https://groups.google.com/g/golang-nuts/c/HUpyQwYVKZE/m/uEOw3N4JGwAJ, but filing here to avoid issue being lost.

I am happy to send a PR if this is acceptable.

### What version of Go are you using (`go version`)?

<pre>
$ go version
go version go1.17 linux/amd64
</pre>

### Does this issue reproduce with the latest release?

Yes


==== [Comments] ====

--- Comment #1 by cherrymui ---
Is error string comparison problematic? I'm not sure if we want to avoid error string comparison and replace errors.New with sentinel errors.

cc @rsc 

--- Comment #2 by kortschak ---
The rationale for using a sentinel is that the sentinel approach is already used in debug/elf. Not using string comparison comes from the fact that the error return is not documented and I have seen numerous times in code reviews that comparison of errors by string value is frowned upon. Given these, and being presented with the option of string comparison or rechecking the system state directly by examining `f.Section("syms")`, I would prefer the latter.

However, adding a sentinel error clearly documents the failure mode, reflects the approach used in the related API in elf, and is more efficient and ergonomic than string comparison.

--- Comment #3 by ianlancetaylor ---
Turning this into a proposal.  It seems fine to me.

--- Comment #4 by rsc ---
Making this work just like elf's ErrNoSymbols seems fine.


--- Comment #5 by gopherbot ---
Change https://golang.org/cl/350229 mentions this issue: `debug/plan9obj: export ErrNoSymbols`

--- Comment #6 by rsc ---

This proposal has been added to the [active column](https://golang.org/s/proposal-status#active) of the proposals project
and will now be reviewed at the weekly proposal review meetings.
â€” rsc for the proposal review group


--- Comment #7 by rsc ---

Based on the discussion above, this proposal seems like a **[likely accept](https://golang.org/s/proposal-status#likely-accept)**.
â€” rsc for the proposal review group


--- Comment #8 by rsc ---

No change in consensus, so **[accepted](https://golang.org/s/proposal-status#accepted)**. ðŸŽ‰
This issue now tracks the work of implementing the proposal.
â€” rsc for the proposal review group

--- Content after FINAL acceptance decision removed ---