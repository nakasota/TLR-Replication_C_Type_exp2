=== Fetching Proposal: MDU6SXNzdWU4MjMyODA2Nzg= ===
Issue URL: https://github.com/golang/go/issues/44815

==== [Issue Title] ====
bufio: use underlying ReadFrom even when data is buffered

==== [Issue Body] ====
`(*bufio.Writer).ReadFrom` will use the underlying writer's `ReadFrom` method if present, but only when the `bufio.Writer` has no data buffered.

When the `http` package writes a request, it first writes the headers to a `bufio.Writer` and then uses `io.Copy` to write the request body. The buffered headers prevent the use of the underlying `net.Conn`'s `ReadFrom`. Flushing the headers before the body may result in an unnecessary additional write, and possibly split a small request across multiple packets.

A similar problem may occur in other cases where a `bufio.Writer` has some amount of data written to it, followed by a large copy.

`ReadFrom` should instead fill out the current buffer, flush it, and then continue the operation with the underlying writer's `ReadFrom` (when present).

```go 
// ReadFrom implements io.ReaderFrom. This calls the underlying writer's ReadFrom method,
// if any. If b has buffered data, this fills the buffer before calling the underlying `ReadFrom`.
func (b *Writer) ReadFrom(r io.Reader) (n int64, err error) {
   ...
}
```

==== [Comments] ====

--- Comment #1 by rsc ---
This seems like a completely reasonable optimization.
We might find a surprise, of course, but I don't see anything wrong with it a priori.

--- Comment #2 by rsc ---

This proposal has been added to the [active column](https://golang.org/s/proposal-status#active) of the proposals project
and will now be reviewed at the weekly proposal review meetings.
â€” rsc for the proposal review group


--- Comment #3 by rsc ---

Based on the discussion above, this proposal seems like a **[likely accept](https://golang.org/s/proposal-status#likely-accept)**.
â€” rsc for the proposal review group


--- Comment #4 by gopherbot ---
Change https://golang.org/cl/340530 mentions this issue: `bufio: use underlying ReadFrom even when data is buffered`

--- Comment #5 by rsc ---

No change in consensus, so **[accepted](https://golang.org/s/proposal-status#accepted)**. ðŸŽ‰
This issue now tracks the work of implementing the proposal.
â€” rsc for the proposal review group


--- Comment #6 by cristaloleg ---
Looks like it's done but not merged? @neild 
