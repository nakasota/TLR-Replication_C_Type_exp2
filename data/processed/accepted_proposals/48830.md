=== Fetching Proposal: I_kwDOAWBuf848w2pT ===
Issue URL: https://github.com/golang/go/issues/48830

==== [Issue Title] ====
x/net/http2: add Transport.WriteByteTimeout

==== [Issue Body] ====
There are currently two ways to detect a broken HTTP/2 connection:

* If a `Read` or `Write` to the `net.Conn` fails.
* If no frames are received from the connection for `ReadIdleTimeout`, and no response is received from the subsequent ping within `PingTimeout`.

Pings are a reliable way to detect a broken connection (with the fix for #48810), but there are times when it would be nice to passively detect an unresponsive peer without needing to actively ping them.

I propose adding an additional knob to `http2.Transport`:

```
// WriteTimeout is the timeout after which the connection will be closed
// if no data can be written to it. The timeout begins when data is written
// to the connection, and is extended if any bytes can be written.
// If zero, no write timeout is set.
WriteTimeout time.Duration
```

Unlike `ReadIdleTimeout`, `WriteTimeout` will apply only at the time we try to write to a connection. Unlike per-request timeouts, `WriteTimeout` applies to the connection as a whole.

==== [Comments] ====

--- Comment #1 by gopherbot ---
Change https://golang.org/cl/354431 mentions this issue: `http2: add Transport.WriteTimeout`

--- Comment #2 by rsc ---

This proposal has been added to the [active column](https://golang.org/s/proposal-status#active) of the proposals project
and will now be reviewed at the weekly proposal review meetings.
â€” rsc for the proposal review group


--- Comment #3 by neild ---
Perhaps a better name is `(http2.Transport).WriteByteTimeout`, since `http.Server` has a `WriteTimeout` field which applies to writing an entire response.

--- Comment #4 by rsc ---

Based on the discussion above, this proposal seems like a **[likely accept](https://golang.org/s/proposal-status#likely-accept)**.
â€” rsc for the proposal review group


--- Comment #5 by rsc ---

No change in consensus, so **[accepted](https://golang.org/s/proposal-status#accepted)**. ðŸŽ‰
This issue now tracks the work of implementing the proposal.
â€” rsc for the proposal review group

