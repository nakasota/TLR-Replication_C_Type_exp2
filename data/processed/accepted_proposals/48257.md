=== Fetching Proposal: MDU6SXNzdWU5OTE0MTg2MzQ= ===
Issue URL: https://github.com/golang/go/issues/48257

==== [Issue Title] ====
cmd/go: add a `go work use` command

==== [Issue Body] ====
This proposal is an amendment of the Go Workspace Proposal (#45713) originally suggested by @jayconrod in a [comment](https://github.com/golang/go/issues/45713#issuecomment-908746458) on that issue:

> I'd like a way to add all modules in a subtree to a workspace using wildcards. Specifically, I'd like `go workspace add ./...`.
> * `go workspace use` would be a better subcommand name if we end up using that in `go.work`.
> * I think this would help build a more familiar environment for folks used to working on related projects in `GOPATH`. I could put a `go.work` file in `$GOPATH/src`, then just have one VSCode window for all projects.
> * We've talked about supporting wildcards in `go mod initwork` and `go mod editwork`, but that breaks some parallelism with `go mod init`, which only creates an empty `go.mod` file, and `go mod edit`, which only performs low-level syntactic edits without extra processing.

This proposal would add a new `go` command subcommand, perhaps called `go mod addwork` (if #48256 is accepted, the new subcommand would be called `go work add` or `go work use`).

It would ensure that the go.work command contains modules denoted by the given pattern, removing any matches of the pattern that no longer exist on disk.

cc  @bcmills @ianthehat 

==== [Comments] ====

--- Comment #1 by bcmills ---
Would there be a corresponding command to remove modules from the workspace? (That could be useful for, say, scripting.)

--- Comment #2 by matloob ---
Modules can still be removed by `go mod editwork`, and `go mod addwork` will remove any modules that match the pattern but don't exist on disk.

--- Comment #3 by rsc ---

This proposal has been added to the [active column](https://golang.org/s/proposal-status#active) of the proposals project
and will now be reviewed at the weekly proposal review meetings.
â€” rsc for the proposal review group


--- Comment #4 by hyangah ---
@rsc Is it possible to review https://github.com/golang/go/issues/48256 together at the proposal review meetings? (`go mod addwork` vs `go work add`) That proposal is not in the active column yet. 

> This proposal would add a new go command subcommand, perhaps called go mod addwork (if #48256 is accepted, the new subcommand would be called go work add or go work use). 

--- Comment #5 by rsc ---
@hyangah added to my list for next meeting, thanks. Not sure how I missed that one.


--- Comment #6 by matloob ---
In consultation with @jayconrod @rsc and @bcmills, we want to rename this proposed command to `go work use` (or `go mod usework` if #48256 isn't accepted). Along with renaming the command, we'd rename the `directory` to to `use`. `go work use` would add a single directory or set of directories stated on the command line and `go work use -r` would search all subdirectories recursively and add the modules it finds (or remove modules in the go.work file that are contained in the directory but no longer exist).

--- Comment #7 by rsc ---

Based on the discussion above, this proposal seems like a **[likely accept](https://golang.org/s/proposal-status#likely-accept)**.
â€” rsc for the proposal review group


--- Comment #8 by rsc ---

No change in consensus, so **[accepted](https://golang.org/s/proposal-status#accepted)**. ðŸŽ‰
This issue now tracks the work of implementing the proposal.
â€” rsc for the proposal review group


--- Comment #9 by gopherbot ---
Change https://golang.org/cl/359534 mentions this issue: `cmd/go: add go work use command`

--- Comment #10 by gopherbot ---
Change https://golang.org/cl/359412 mentions this issue: `modfile: rename directory directive to use`

--- Comment #11 by matloob ---
This is done.

--- Comment #12 by gopherbot ---
Change https://golang.org/cl/382240 mentions this issue: `cmd/go: fix relative-path normalization in go.work files`
