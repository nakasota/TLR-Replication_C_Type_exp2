=== Fetching Proposal: Breaking Go's principles ===
Issue URL: https://github.com/golang/go/issues/39893

==== [Issue Title] ====
proposal: context: add Context.IsCanceled method

==== [Issue Body] ====
please add function like that to the context type:
func (c Context) IsCanceled() {
select {
case <- c.Done():
return true
default:
return false
}
}
or something like that to simplify context cancelation checking in channelless situations by something like that:
if ctx.IsCanceled() {
return ctx.Err()
}


==== [Comments] ====

--- Comment #1 by ianlancetaylor ---
The proposed function is the same as `ctx.Err() != nil`.  It doesn't seem to add much.  In particular the case at the bottom would normally be written

```Go
    if err := ctx.Err(); err != nil {
        return err
    }
```

which seems preferable to me.

--- Comment #2 by rsc ---
As Ian pointed out, ctx.Err is exactly this function (returning an error instead of a boolean).
In #19856, we made sure that this idiom is valid - Err is allowed before the Done channel is closed, and it must return nil.


--- Comment #3 by carnott-snap ---
While you could implement a func that is pure syntax sugar, I agree the justification seems weak:
```go
package context

func IsCanceled(ctx Context) bool { return ctx.Err() == Canceled }
```

--- Comment #4 by rsc ---
Based on the discussion above, this seems like a **likely decline**.


--- Comment #5 by davecheney ---
Thereâ€™s also the issue of a logical race, the context may be canceled after the call to IsCancelled but before the code responding to that condition has run. 

--- Comment #6 by rsc ---
No change in consensus, so declined.


--- Comment #7 by rsc ---
Forgot to close in July.
