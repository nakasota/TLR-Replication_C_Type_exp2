=== Fetching Proposal: Deprecated proposals ===
Issue URL: https://github.com/golang/go/issues/41896

==== [Issue Title] ====
proposal: reflect: add Type.IsEmptyInterface

==== [Issue Body] ====
Coming from #41882, @ianlancetaylor suggests adding:

```
func IsEmptyInterface(t reflect.Type) bool
```

to `reflect` package to detect empty interface.

Currently, users (including standard libraries, Google internal code, are relying on `reflect.Type.NumMethod() == 0` to check empty interface, which is wrong. After #22075 is fixed, code which uses wrong behavior should be changed to:

```
reflect.TypeOf((*interface{})(nil)).Elem().Implements(T)
```

Adding `reflect.IsEmptyInterface` will help user's migration easier.

==== [Comments] ====

--- Comment #1 by ianlancetaylor ---
See discussion in #41882.

--- Comment #2 by mdempsky ---
A few thoughts:

1. Adding a new function to package reflect makes sense for long-term stable state, but users during transition who want to support both Go 1.15 and Go 1.16 will need a solution outside of the standard library. The solution is simple enough to just copy/paste into their own code if necessary. But it might be nice to save them this hassle.

2. Do we declare it as a standalone function or as a method? (I don't immediately see any significant technical arguments either way, except that it can only be a method if declared in package reflect.)

3. I recommend `IsEmptyInterface(T)` return false if `T` is not an interface type. The function has to check this anyway, and it seemed like a handful of users were checking `t.Kind() == reflect.Interface && t.NumMethod() == 0` together. So it's slightly nicer to them (and marginally more efficient) if they can just write `IsEmptyInterface(t)`.

--- Comment #3 by gopherbot ---
Change https://golang.org/cl/263078 mentions this issue: `internal/reflectutil: add helper function to detect empty interface`

--- Comment #4 by ianlancetaylor ---
See also #42099.

--- Comment #5 by rsc ---
We are probably going to roll back that change - see #42123 - so it looks like we don't need this.

--- Comment #6 by cuonglm ---
> We are probably going to roll back that change - see #42123 - so it looks like we don't need this.

I still think we should add this method, to provide a better/correct way for user to detect empty interface.

--- Comment #7 by rsc ---
It's certainly easy to go overboard on helpers.
We've come a long way without this one, and NumMethod() == 0 is both clear and correct.


--- Comment #8 by rsc ---
Since we rolled back that change, this seems like a **likely decline**.


--- Comment #9 by rsc ---
No change in consensus, so declined.

