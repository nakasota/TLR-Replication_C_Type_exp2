==== [Issue Title] ====
proposal: crypto/cipher: allow short tags in NewGCMWithNonceAndTagSize

==== [Issue Body] ====
With the new API for customizing GCM tag size, it's finally possible to reduce the GCM tag overhead for some applications.  However, the new API comes with a [hard limit](https://github.com/golang/go/blob/master/src/crypto/cipher/gcm.go#L144) on the minimal tag size, 12 bytes, which is just a 4 bytes saving compare to the default value. 

For our use case, we use AES128-GCM to perform EtA on an IP packet flow. The data to encrypt has a bounded max size, and we call the authenticated decryption function for a limited times.  As we meets the circumstances described in Appendix C of the NIST 800-38D, using an 8-byte tag would be an overkill (<1400B payload and <2^31 invocations).

For the above reason, I'm proposing to relax the limit on the minimal tag size, and add a longer doc string for this function.  It's understandable that a crypto library should be safe to use with it's default parameters without further mangling, but for an API designed to customize the behavior should provide more flexibility. 


==== [Comments] ====

--- Comment #1 by rsc ---
It seems like NewGCMWithNonceAndTagSize should at least be NewGCMWithSizes or NewSizedGCM or something shorter like that.

I don't know the security implications of allowing < 12 byte tags. /cc @agl @FiloSottile 


--- Comment #2 by ashi009 ---
@rsc  I can send a 3-line CL for this one -- probably not the renaming bit but just change the const and add some extra doc strings ;)

--- Comment #3 by rsc ---
Two issues:

1. NewGCMWithNonceAndTagSize should maybe be just NewGCMWithTagSize. The ability to change the nonce was a workaround for one special protocol, not a typical general need.
2. Using the smaller tags is not always safe. We're worried about people misusing small tags and ending up with security problems. One possibility is to panic if too large a packet is used with too small a tag.

It's not clear from the original report what tag size you are asking for, @ashi009, since you said "8 byte would be overkill". What are you looking for?



--- Comment #4 by ashi009 ---
1. Understood. (Also noticed that the naming issue is tracked in #24977)
2. Choosing a secure tag size should be the user's responsibility, as they have diverged from the safe default. I'd say just put a big warning on top, and let them to decide.

I'd go with 6 bytes tag.  My calculations shows that it's sufficient for our use case (data obfuscation and weak integration check, as the cleartext is encrypted already).  

Also as shown in [NIST 800-38D Appendix C](https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38d.pdf), 8 bytes tag can be used to encrypt cleartext up to 2^15B for no more than 2^32 times. Which exceeds our need by magnitudes.


--- Comment #5 by FiloSottile ---
Reading that Appendix is fairly terrifying. It does not simply provide a table of bounds, but also recommends that short tags only be used when _some_ fake packets are acceptable. That is well outside the realm of [safe APIs](https://golang.org/design/cryptography-principles), and I don't think we should do it. Even for 8 bytes tags, it would be hard to document the bounds, because it's a two values table, and not absolute caps. I do regret having NewGCMWithTagSize at all, but we should not worsen the mistake, also because it looks like there were no other requests for this over the past two years.

--- Comment #6 by rsc ---
Based on the discussion above and the general lack of activity, this seems like a **likely decline**.


--- Comment #7 by rsc ---
No change in consensus, so declined.

