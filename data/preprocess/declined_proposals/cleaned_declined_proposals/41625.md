==== [Issue Title] ====
proposal: net/mail: allow AddressParser helper code to signal invalid character set

==== [Issue Body] ====
<!--
Please answer these questions before submitting your issue. Thanks!
For questions please use one of our forums: https://github.com/golang/go/wiki/Questions
-->

### What version of Go are you using (`go version`)?

<pre>
$ go version
go version go1.15.2 darwin/amd64
</pre>

### Does this issue reproduce with the latest release?

Yes

### What operating system and processor architecture are you using (`go env`)?

<details><summary><code>go env</code> Output</summary><br><pre>
$ go env
GO111MODULE=""
GOARCH="amd64"
GOBIN=""
GOCACHE="/Users/tt/Library/Caches/go-build"
GOENV="/Users/tt/Library/Application Support/go/env"
GOEXE=""
GOFLAGS=""
GOHOSTARCH="amd64"
GOHOSTOS="darwin"
GOINSECURE=""
GOMODCACHE="/Users/tt/pkg/mod"
GONOPROXY="github.com/tt"
GONOSUMDB="github.com/tt"
GOOS="darwin"
GOPATH="/Users/tt:/Users/tt/libraries"
GOPRIVATE="github.com/tt"
GOPROXY="https://proxy.golang.org,direct"
GOROOT="/usr/local/Cellar/go/1.15.2/libexec"
GOSUMDB="sum.golang.org"
GOTMPDIR=""
GOTOOLDIR="/usr/local/Cellar/go/1.15.2/libexec/pkg/tool/darwin_amd64"
GCCGO="gccgo"
AR="ar"
CC="clang"
CXX="clang++"
CGO_ENABLED="1"
GOMOD="/Users/tt/src/github.com/tt/mail/go.mod"
CGO_CFLAGS="-g -O2"
CGO_CPPFLAGS=""
CGO_CXXFLAGS="-g -O2"
CGO_FFLAGS="-g -O2"
CGO_LDFLAGS="-g -O2"
PKG_CONFIG="pkg-config"
GOGCCFLAGS="-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=/var/folders/v3/slr36r597rn0rrfzq_my6nv00000gn/T/go-build296585987=/tmp/go-build -gno-record-gcc-switches -fno-common"
</pre></details>

### What did you do?

<!--
If possible, provide a recipe for reproducing the error.
A complete runnable program is good.
A link on play.golang.org is best.
-->

I assigned a `mime.WordDecoder` to `mail.AddressParser` in order to be able to support more charsets.

This changes the behavior of the parsing:

- `(&mail.AddressParser{}).Parse("=?foo?Q?=00?= <foo@example.com>")` returns no value and the error (`&errors.errorString{s:"mail: missing word in phrase: charset not supported: \"foo\""}`)
- `(&mail.AddressParser{WordDecoder: &mime.WordDecoder{}}).Parse("=?foo?Q?=00?= <foo@example.com>")` returns the value `&mail.Address{Name:"=?foo?Q?=00?=", Address:"foo@example.com"}` and no error

Assigning the decoder's `CharsetReader` makes no difference.

See [this Go playground](https://play.golang.org/p/Lw0ssPUZVYd) for an example.

### What did you expect to see?

I would expect to be able to still error when encountering an unsupported charset and maybe generally to know whether any error occurred.

### What did you see instead?

The error was ignored and the name was set to the decoded word.

When `mail.AddressParser` was first implemented in 1defd227bd464d13ce32df08594d6642a15ca0b4, it would return any error.

That changed in 6491496d10c8e7e62f875c7781a2887564976b89 and since only the unexported `charsetError` is treated as an error:

https://github.com/golang/go/blob/3e636ab9ad31040aff2d484237808907a776cec6/src/net/mail/message.go#L733-L750

However, it feels like an unintended consequence of that commit.

I think one approach to solving this would be moving `charsetError` to the `mime` package (where [`mime.WordDecoder` itself could use it](https://github.com/golang/go/blob/3fb3ca083c650b933919d3b6a45268fce339ac38/src/mime/encodedword.go#L342-L344)) and exporting it.

==== [Comments] ====

--- Comment #1 by gopherbot ---
Change https://golang.org/cl/257398 mentions this issue: `mime: define CharsetError`

--- Comment #2 by ianlancetaylor ---
I think the change in error handling happened in https://golang.org/cl/7890 aka 2b0361084258b78cc8ed6e2dc6924985dbbcd3bf

--- Comment #3 by odeke-em ---
Thank you for filing this bug @tt! As @ianlancetaylor mentioned on your CL https://go-review.googlesource.com/c/go/+/257398, exporting new errors requires a proposal review firstly. Could you please convert this issue into a proposal and I can help you tweak the title but please help tweak the body to make it a concrete proposal. Thank you!

--- Comment #4 by odeke-em ---
Given the current rush for time and the fact that holding this up presents a potential bug, we can apply a pragmatic approach with either:
a) Keep the error in net/mail unexpected as is, and then do a string.HasPrefix check with a comment and link to the proposal link
```go
	if if _, ok := err.(charsetError); ok {
		return s, true, err
	} else if strings.HasPrefix(err.Error(), "mime: unhandled charset") {
                 // Unfortunately before we have an exported cross-package error,
                 // we have to rely on string matching. TODO: replace this check with
                 // errors.Is/As whenever  https://golang.org/issue/41625 is accepted.
		return s, true, err
         }
```
b) Create an internal package called customerrors or so, and in it define that error that can then
be freely moved around or later when we the proposal for mime.CharsetError is accepted, just create a type alias
```go
type CharsetError = customerrors.CharsetError
```

--- Comment #5 by rsc ---
It doesn't seem like we should change anything for Go 1.16.

For the future, why does mime need to export the CharsetError? Why not net/mail?


--- Comment #6 by odeke-em ---
The parsing starts from mime which is where it is necessary. However I
proposed 2 alternatives to begin with: 1. Internal package 2. Sub string
match.

On Wed, Oct 28, 2020 at 10:51 AM Russ Cox <notifications@github.com> wrote:

> It doesn't seem like we should change anything for Go 1.16.
>
> For the future, why does mime need to export the CharsetError? Why not
> net/mail?
>
> —
> You are receiving this because you commented.
> Reply to this email directly, view it on GitHub
> <https://github.com/golang/go/issues/41625#issuecomment-718104488>, or
> unsubscribe
> <https://github.com/notifications/unsubscribe-auth/ABFL3V7HKT6HIIDC4YC4UHDSNBKY5ANCNFSM4RZHM35Q>
> .
>


--- Comment #7 by rsc ---
It looks like if WordDecoder.CharsetReader returns _any_ error, that should be taken to mean "character set not supported". 
It's unclear why we'd need to export a specific error when every error result should mean that.

So maybe some code in mime or net/mail needs to be more careful about doing that, and there is just a bug here.


--- Comment #8 by rsc ---
I finally looked at this and mailed https://go-review.googlesource.com/c/go/+/283632.
It's just a bug, not something that needs new API.


--- Comment #9 by gopherbot ---
Change https://golang.org/cl/283632 mentions this issue: `net/mail: improve detection of charset errors`

--- Comment #10 by rsc ---

Based on the discussion above, this proposal seems like a **[likely decline](https://golang.org/s/proposal-status#likely-decline)**.
— rsc for the proposal review group


--- Comment #11 by rsc ---

No change in consensus, so **[declined](https://golang.org/s/proposal-status#declined)**.
— rsc for the proposal review group

