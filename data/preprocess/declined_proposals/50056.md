=== Fetching Proposal: Existing alternatives ===
Issue URL: https://github.com/golang/go/issues/50056

==== [Issue Title] ====
proposal: net/http: add Unregister method to ServeMux

==== [Issue Body] ====
Currently it is not possible to dynamically register and deregister path handlers with a `ServeMux` object. Once a handler for a path is registered, it cannot be changed or removed.
Solutions to work around this (such as wrapping `ServeMux`) can lead to a growing map containing stale handlers.

The proposal is to add an `Unregister` method with the following function signature:
`func (mux *ServeMux) Unregister(pattern string)`

==== [Comments] ====

--- Comment #1 by ianlancetaylor ---
CC @neild @bradfitz 

--- Comment #2 by earthboundkid ---
Seems extremely racey. 

If you need this functionality, why not just register a handler for / and then mux it yourself at runtime? I don't think this fits into the usecase for the standard serve mux, and it's very easy to write your own, so I would be opposed to any performance hit that would come from checking a lock at runtime.

--- Comment #3 by rgooch ---
The internal locking protects against basic races.
Creating a custom mux doesn't work well with libraries that use `DefaultServeMux`.

--- Comment #4 by neild ---
I don't think this is generally useful enough to warrant adding, and I suspect that a need to unregister handlers from a `ServeMux` points at a deeper design issue somewhere. For example, a library which is hardcoded to use `http.DefaultServeMux` depends on shared global state.

--- Comment #5 by rsc ---
The design of ServeMux is intentionally order-independent, so that if you have things registered from init functions, it doesn't matter what order the init functions run. I'm very wary of adding something that would introduce order dependence in this API.

There are many other options if you need this functionality, of course, including writing a trivial custom mux.



--- Comment #6 by rsc ---

This proposal has been added to the [active column](https://golang.org/s/proposal-status#active) of the proposals project
and will now be reviewed at the weekly proposal review meetings.
— rsc for the proposal review group


--- Comment #7 by rsc ---

Based on the discussion above, this proposal seems like a **[likely decline](https://golang.org/s/proposal-status#likely-decline)**.
— rsc for the proposal review group


--- Comment #8 by rsc ---

No change in consensus, so **[declined](https://golang.org/s/proposal-status#declined)**.
— rsc for the proposal review group

