strconv: add parsecomplex
strconv.parsecomplex( string, bitsiz int) (complex128, error)
think import `regexp` `strings` keep packag small. heavili recommend (instead fmt) gopherj exactli reason.
exactli format(s) think accept?
note languag defin format complex expression. instead defin imaginari liter (an integ float point constant follow `i`). complex constant simpli constant express includ least one imaginari literal. think @josharian ask good question here. want strconv packag pars arbitrari expression.
said, implicit definit pars complex constant `fmt.scan`, implement method `fmt.(*ss).complextokens` ( syntax seem user-vis documentation. could decid move method `strconv.parsecomplex`.
let know done far address concerns.
pr:
accept:
```
- (±34.3±234.2i)
- ±34.3±234.2i
- exponential form
- hexadecimal form
- NaN
- ±Inf±Infi
- only real
- only imag
```
chang mention issue: `strconv: add parsecompex function`
news this?
`fmt.print` `fmt.scan` implicit format complex numbers:
float+/-floati (float+/-floati)
format accept decim hex floats, nan inf either floats.
float have:
func parsefloat( string, bitsiz int) (float64, error)
func formatfloat(f float64, fmt byte, prec, bitsiz int) string
seem like need
func parsecomplex( string, bitsiz int) (complex128, error)
func formatcomplex(c complex128, fmt byte, prec, bitsiz int) string
seem like hole forgot fill.
/cc @robpik @griesem
seem like reason thing add, parallel float64 support @rsc says. would good see fmt packag adapt well use it.
`formatcomplex` return?
- bracket without brackets?
- hex alway decimal?
formatcomplex probabl put parens, fmt.
question hex decim control fmt byte,
like printf: 'x' get hex.
example, believ test fmt show fmt='x' prec=3 do:
```
fmt_test.go:532:	{"%.3x", 0i, "(0x0.000p+00+0x0.000p+00i)"},
fmt_test.go:538:	{"%.3x", 1 + 2i, "(0x1.000p+00+0x1.000p+01i)"},
fmt_test.go:542:	{"%.3x", -1 - 2i, "(-0x1.000p+00-0x1.000p+01i)"},
```
cool. implement formatcomplex. unit test later.
base discussion, seem like **like accept**.
chang consensus, accepted.
happen now? well go 1.15?
accept propos mean ok make change. case alreadi sent cl, appropri maintain need review it. 1.15 get review accepted.
initi prototyp use logic alreadi strconv.parsefloat @pjeb shall take look cl.
possibl keep string packag heavili use environ like gopher.j @odeke-em
sure, @pjebs, thank let know :) let' take cl, post feedback.
@odeke-em thank feedback. make variou adjust accord suggestions. told accept `(n±ni)` format per
gotcha! interpret comment of: format isn’t
defin ye shouldn’t accept arbitrari expressions. howev
go parser compil accept either form complex
constants:
real joining_sign imag
imag joining_sign real
think natur go user expect abl
use of:
-30-50i
-50i-30
or:
-50i
or:
-30
well form ieee 754 float constants. ian
mention complex constant affix “i”.
cl current accepts: -30-50i -50i-30. think make
accept latter form, meet middl hybrid
suggestions.
sat, apr 11, 2020 7:21 pm pj <notifications@github.com> wrote:
> @odeke-em < thank feedback.
> make variou adjustments. told accept (n=ni) format
> per #36771 (comment)
> <
>
> —
> receiv mentioned.
>
>
> repli email directly, view github
> <
> unsubscrib
> <
> .
>
got confus @ianlancetaylor point "implicit definition" go current accept states:
```
// complexTokens returns the real and imaginary parts of the complex number starting here.
// The number might be parenthesized and has the format (N+Ni) where N is a floating-point
// number and there are no spaces within.
```
interpret alreadi code parses/accept `(n+ni)` @ianlancetaylor want replac exist code (in `fmt`) new `strconv.parsecomplex`, case creat break go1 backward compat policy.
format accept propos exactli one , simpler constrain @odeke-em suggest above.
thank clarif interpret
accepted, ian. alright, futur we’v merg relat cl.
user request it, would logic us accept ni+n well?
sat, apr 11, 2020 8:10 pm ian lanc taylor <notifications@github.com>
wrote:
> format accept propos exactli one #36771
> (comment)
> < ,
> simpler constrain @odeke-em
> < suggest above.
>
> —
> receiv mentioned.
> repli email directly, view github
> <
> unsubscrib
> <
> .
>
case, @odeke-em remov comment made relat expand definition. believ cosmet adjust left.
acknowledged, thank @pjeb @ianlancetaylor clarification. shall updat comment cl.
@odeke-em finish amend pr base comments.
thing chang suggest chang `ieee754` `ieee 754` `parsecomplex` doc comment directli `parsefloat` function that' there.
thank review.
also notic surpris star'd package.
>@odeke-em finish amend pr base comments.
awesome, shall take look also kindli rope @griesem final look.
>also notic surpris star'd package.
aye aye. nice work ergonimcs, hope use sometim future!
code alreadi (implicitly) reject malform parenthesi
@odeke-em
issues:
> ps8, line 10
> suggest added.
meant chang commit messag initi commit? it?
> need ensur malform parenthesi throw error e.g.:
`parsefloat` function alreadi take care reject malform parenthesis. need cater explicitly. see test cases.
> code intuit does.
would nice explain logic figur what' real what' imaginary.
ad detail comment explain logic. feel algorithm approach simpler logic understood.
