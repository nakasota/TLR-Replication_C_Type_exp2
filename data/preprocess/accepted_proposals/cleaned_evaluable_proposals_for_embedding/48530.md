net: add tcp writeto func enabl splice socket data file
transfer data tcp socket file directly, splice help us low time cost linux. currently, `os.file` use `write` transfer data tcp socket.
linux, changes:
1. add `limitwriter` detect write limit intern package, discuss issues.
2. add `splicew` function splice data tcp socket file.
3. add `writeto` function `net.tcpconn`.
get 10% least cpu time reduce, zero memori copi kernel user space.
!imag
implement pr: #46149, go review
specif api chang proposing?
propos ad activ column propos project
review weekli propos review meetings.
â€” rsc propos review group
look like direct api chang tcpconn implement io.writerto ad writeto method.
mean io.copy(dst, src) src tcpconn
dst readfrom use src.writeto instead dst.readfrom.
case matters?
dst src networks, presum end splice either way.
kind dst matter?
splice applic specif tcpconn,
fall back io.copy(dst, nowriteto{src}),
still get dst.readfrom.
possibl chang splice option best option. case exist?
find case, tcpconn.writeto alway use splice then.
base discuss above, propos seem like **like accept**.
â€” rsc propos review group
> look like direct api chang tcpconn implement io.writerto ad writeto method. mean io.copy(dst, src) src tcpconn dst readfrom use src.writeto instead dst.readfrom. case matters? dst src networks, presum end splice either way. kind dst matter?
>
> splice applic specif tcpconn, fall back io.copy(dst, nowriteto{src}), still get dst.readfrom.
>
> possibl chang splice option best option. case exist?
currently, find two cases:
* `net.tcpconn` `os.file`
* `net.tcpconn` `net.tcpconn`
two case handl
chang consensus, **accepted**. ðŸŽ‰
