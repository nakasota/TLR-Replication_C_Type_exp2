build: adopt go 1.17 bootstrap toolchain go 1.20
**i propos start go 1.18 dev cycle, requir go 1.16 go bootstrap version (instead go 1.4).**
switch write go compil itself, wrote two propos relat bootstrap process.
origin proposal, (decemb 2013), overal process convert compil go.
proposal, wrote:
> go compil written go, must plan bootstrap scratch. rule plan adopt go 1.3 compil must compil use go 1.2, go 1.4 must compil use go 1.3, on. clear path gener current binaries: build go 1.2 toolchain (written c), use build go 1.3 toolchain, on. shell script this; take cpu time human time. bootstrap need done per machine; go 1.x binari kept known locat reus time all.bash run develop go 1.(x+1).
>
> obviously, bootstrap path scale poorli time. mani releas gone by, may make sens write back end compil gener c code. code need effici readable, correct. c version would check in, today check y.tab.c file gener yacc. bootstrap sequenc would invok gcc c code build bootstrap compiler, bootstrap compil would use build real compiler. like scheme, bootstrap compil binari kept known locat reus (not rebuilt) time all.bash run.
fairli hypothetical, certainli longer believ make sens write c back end go compiler. (in fact, windows/arm64 port did, work go toolchain still know c compil suppos use!)
final proposal, (januari 2015), simplifi process iter one hard-cod go 1.4 bootstrap toolchain:
> build go 1.x, x â‰¥ 5, necessari go 1.4 (or newer) instal already, $goroot_bootstrap. default valu $goroot_bootstrap $home/go1.4. gener keep use go 1.4 bootstrap base version long possible. toolchain proper (compiler, assemblers, linkers) need buildabl go 1.4, whether restrict featur use go 1.4 use build tags.
import simplification, especi peopl packag go systems. decis serv us well.
six year sinc go 1.4. much happen world go, mani bug fixed. mani system go run today support go 1.4 (includ darwin/arm64 m1 macs). use newer toolchain bootstrap, system could too. higher level, go far matur wide avail go 1.4 era. ton avail binari distribut use bootstrapping.
propos go 1.17 last version go requir go 1.4 bootstrapping, go 1.18 requir go 1.16 bootstrapping.
go 1.16 would remain bootstrap version next year least.
**whi go 1.15?**
- go 1.16 ad `//go:build` support. want compil keep use `+build` even go world move on. (**edit**: half true: see
**whi go 1.17?**
- there' compel featur ad go 1.17.
- use go 1.16 new bootstrap toolchain give packag chanc test chang need make use go 1.17,
would still work go 1.4.
- go 1.17 first releas use new register-bas abi, like linger bug take shake out.
(see next section.)
**whi go 1.18?**
- go 1.18 contain initi implement generics, go requir mani _many_ new line code, certainli contain subtl bugs. adopt go 1.18 bootstrap toolchain, stuck work around bug mani year come. better lock last releas churn version need hold long term.
**whi quickli roll version?**
note above, think serv us well fix version requir build go, oppos automat slide version origin envisioned. packag benefit updat package-build script provid differ environ new go release.
time, bump version forward everi five year let us take advantag newer go capabl port let us retir old compat shim (standard librari packag like sort carri variou +build' file keep build go 1.4). modern c compil written pre-ansi c.
**what slow-rol version?**
that' essenti propos would establish practice, although without specif timeline.
next obviou entri sequenc go 1.4 go 1.16 go 1.256, follow go 1.65536.
(or perhap quit right pattern establish.)
use date instead, assum switch go 1.16 go 1.18 (feb 2022), seem reason revisit bootstrap version four year later, current releas cycl would mean use go 1.24 (feb 2025) go 1.26 (feb 2026).
propos establish sequence, would depend mani factors.
pick go 1.16 bootstrap version start go 1.18.
actually, confus write this.
go 1.16 **not** know read `//go:build` lines,
know reject file contain `//go:build` without `// +build`.
futur gofmt know sync (â‰  insert) `// +build` line alongsid `//go:build`
that' enough bootstrap toolchain.
abl assum recent compil bootstrap would realli nice rememb quirk go 1.4, need worri work around long-fix issues.
fwiw, openjdk appear requir immedi previou releas bootstrap (see "build jdk requirements"), also 6-month releas cycl ( build openjdk take way longer run make.bash does. think need nearli aggress uprev' go bootstrap versions, think least suggest end user could toler anoth uprev 1.256. :)
good idea, however, perhap would make sens additionali declar bootstrap version go also go long term support "lts" version, keep receiv backport bugfix 4 year (or whatev support period bootstrap version go be). organ developments, stabl lt version keep receiv bug fix extrem valuable.
fwiw, level aggress bootstrap version bump openjdk big hurdl toward recent openjdk packag backport distribut releas (and requir lot extra coordin / "fanci footwork" maintain coordin "hack" around).
concret exampl go, could make ad new architectur difficult distribut until/unless `gccgo` get updat 1.16 (becaus `gccgo` often use bootstrap-build order onboard new architectur without someth drastic like upload old version go newer version number "stepping" upward supported, realli disrupt architectur -- altern cross-building, challeng own).
imo would easier understand/stomach propos version one that' alreadi support least recent `gccgo` releas (which believ gcc 10 1.14?)
note gcc 11 support go 1.16.
propos ad activ column propos project
review weekli propos review meetings.
â€” rsc propos review group
base discuss above, propos seem like **like accept**.
â€” rsc propos review group
chang consensus, **accepted**. ðŸŽ‰
