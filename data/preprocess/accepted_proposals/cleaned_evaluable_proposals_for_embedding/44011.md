syscall: add addit field sysprocattr window
two addit attribut would use expos user sysprocattr: proc_thread_attribute_handle_list (via `sysprocattr.additionalinheritedhandles`) proc_thread_attribute_parent_process (via `sysprocattr.parentprocesshandle`), document here:

microsoft ad later point (window vista) attribut alreadi support startprocess/sysprocattr, intern there' slightli differ way pass createprocess, that' weird implement quirk bear go user.
proc_thread_attribute_handle_list particular special signific actual *already* use uncondit basic reliability. specifically, *always* use proc_thread_attribute_handle_list launch processes, order prevent handl leak prevent race function like shellexecute. might even abl remov global lock use hack around absenc proc_thread_attribute_handle_list, would great.
end, propos follow 3 steps:
1. alway use proc_thread_attribute_handle_list handl want inherited, automatically. new api first point rather make exist logic robust. import reliabl fix.
2. add `sysprocattr.additionalinheritedhandles` take list handl add list point (1).
3. add `sysprocattr.parentprocesshandle` add proc_thread_attribute_parent_process value.
point (1) bug/reli fix requir propos process, submit bore cl independ proposal. therefor propos concern adding:
- `sysprocattr.additionalinheritedhandles`
- `sysprocattr.parentprocesshandle`
think addit attribut expos via sysprocattr, happi add propos too.
altern #44005, opinion would big mistake.
cc @mattn @bradfitz @alexbrainman
> * `sysprocattr.additionalinheritedhandles`
need function now. plan work feature.
> * `sysprocattr.parentprocesshandle`
propos determin scenario `i want chang new process parent`? assum use 0 indic scenario. possibl parent process handl 0? anyway need clearli documented.
access sysprocattr.parentprocesshandl would solv particular problem.
#44005 provid gener solution. #44005 complicated, base current microsoft offici documentation. question is, add #44005 all, add new sysprocattr field / field someon need one mani list

?
alex
adopt #44005 support pretti much case. adopt propos add case time. #44005 also seem akin approach taken gnu/linux, field like `cloneflags` `unshareflags` `ambientcaps`.
> adopt #44005 support pretti much case. adopt propos add case time.
correct.
read jason' proposal, get impress believ proc_thread_attribute_handle_list proc_thread_attribute_parent_process `would use expose`. know correct is. time tell.
and, appear me, microsoft even add option pass updateprocthreadattribut window api time (if discov createprocess window api requir new parameters). #44005 let user handl scenario without talk go team.
alex
> > * `sysprocattr.additionalinheritedhandles`
>
> need function now. plan work feature.
go runtim uncondit use proc_thread_attribute_handle_list already. allow peopl add list import part get weird pipe working, per thread. someth ad matter what.
>
> > * `sysprocattr.parentprocesshandle`
>
> propos determin scenario `i want chang new process parent`? assum use 0 indic scenario. possibl parent process handl 0? anyway need clearli documented.
use zero, yes, match go' convent uniniti struct good-to-go. documented.
> access sysprocattr.parentprocesshandl would solv particular problem.
good.
> #44005 provid gener solution. #44005 complicated, base current microsoft offici documentation. question is, add #44005 all, add new sysprocattr field / field someon need one mani list
definit want expos directli part api os.startprocess. right way expos one one need individu evaluated.
see that' case fact os.startprocess go need use proc_thread_attribute_handle_list _regardless_ anyth els use-provided, mean went bad #44005 approach, sudden requir weird merg structs. that' headach want take on. plu api becom aw use.
> and, appear me, microsoft even add option pass updateprocthreadattribut window api time (if discov createprocess window api requir new parameters). #44005 let user handl scenario without talk go team.
recip disaster. talk os.startprocess here. need paramet pass coher rest go. freeforal lead bad-to-us api break current convent thing done, also mean open futur instabl os.startprocess.
chang mention issue: `syscall: introduc sysprocattr.additionalinheritedhandl windows`
chang mention issue: `syscall: introduc sysprocattr.parentprocess windows`
chang mention issue: `os: mark pipe return os.pipe() inherit default`
chang mention issue: `syscall: restrict inherit handl windows`
chang mention issue: `syscall: add support proc thread attribut lists`
post seri 5 step-by-step commit add abil chang process parent abil pipe thing inherit **safe** way interfer go runtime. also make inherit semant runtim lot reliabl otherwise.
seri also deal complic interact set parent process exist logic pass stdin/out/err, order avoid undefin behavior child process attempt oper bogu handles.
and, final fix #21085 properly, years.
finally, seri keep exist convent expos variou flag startupinfo easi use safe api.
test appear work well. pleas take look.
understand gener #44005, big problem ever want use startupinfoex (such fix problem pipes, above), user-suppli one mean find way merg user-suppli one changes, know detail user mean overrid not.
limit api issu seem like maintain long-term approach make adjust need detail chang futur window versions.
propos ad activ column propos project
review weekli propos review meetings.
â€” rsc propos review group
@gopherbot add os-window
ship seri part wireguard-window 0.3.5, receiv real world testing. far bug report relat it.
base discuss above, propos seem like **like accept**.
â€” rsc propos review group
chang consensus, **accepted**. ðŸŽ‰
