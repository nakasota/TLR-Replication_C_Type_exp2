reflect: back multipl key key:valu pair struct tag
hello ðŸ‘‹
actual bore set valu multipl key struct tag. mayb miss someth bore thing:
```go
type MyStruct struct {
  Field1 string `json:"field_1,omitempty" bson:"field_1,omitempty" xml:"field_1,omitempty" form:"field_1,omitempty" other:"value"`
}
```
propos is:
```go
type MyStruct struct {
  Field1 string `json,bson,xml,form:"field_1,omitempty" other:"value"`
}
```
thank ðŸ‘
note would mean struct tag key cannot contain comma character. current document "each key non-empti string consist non-control charact space (u+0020 ' '), quot (u+0022 '"'), colon (u+003a ':')." would change. course, fairli unlik anybodi use tag key comma.
could break chang course.
larg corpu go code scan point see anyon use , tag name practice.
tri next week.
use space-separ list instead comma-separ one?
```
type MyStruct struct {
  Field1 string `json bson xml form:"field_1,omitempty" other:"value"`
}
```
space form analog happen go argument lists:
`x int, int, z int`, remov repeat ` int`, leav `x, y, z int`.
here,
`json:"x" bson:"x" xml:"x"`, remov repeat `:"x"`, leav `json bson xml:"x"`.
insert comma step, need explain came
(they before!).
space form also quit bit less wall text thu easier skim. compare:
field1 string `json bson xml form:"field_1,omitempty" other:"value"`
field1 string `json,bson,xml,form:"field_1,omitempty" other:"value"`
unlik comma, space cannot appear valid tag today,
would redefin technic valid syntax mean
someth slightli different.
space-separ much better inde look like go argument list.
regard proposal: use 1 file tag (json yaml) before, last week play differ config file leav verbos repetit (`field1` json, also yaml, also toml, also ...) make multi-tag much easier use.
must admit space separ could good idea wonâ€™t break anything.
person feel less comprehens comma separ go comma argument (~~we donâ€™t write `a b c int` comma go fact lol~~ ok understand space go fact) choic made donâ€™t belong :)
even space separated, main issu resolv itâ€™ ok ! ;)
ok, syntax suggest last thursday (space-separ instead comma-separ keys), concern backward compatibility. much discuss otherwise.
make progress analyz tag go corpu last week, found 0.06% tag comma key (outsid quot values). mistakes. could plausibl use comma break things, space keep current syntax anyway.
base discuss above, seem like **like accept** (with spaces, commas).
clear, new syntax would be:
```
type MyStruct struct {
  Field1 string `json bson xml form:"field_1,omitempty" other:"value"`
}
```
chang consensus, accepted.
hi! would like work feature. possible? :)
sure, go ahead.
chang mention issue: `reflect: ad multipl key support struct tags`
hello @bynov . still work this?
hi, @deven96
alreadi sent pr gerrit. review :)
lol... darn
goodluck mate @bynov
hello, version go featur avail ?
@scorsi probabl feb 2021, go 1.16 released.
chang mention issue: `reflect: document multipl key struct tags`
tri add new syntax one tool `gomodifytags` use mani editor (i.e: vscode, vim, etc..). allow one add remov struct tag easi way. find detail here:
one particular edg case found is, assum user want add new tag exist field value.
```go
type T struct {
	Server string `json:"server"`
}
```
ad new key old format would produce:
```go
type T struct {
	Server string `json:"server" xml:"server"`
}
```
new format, tool need output in:
```go
type T struct {
	Server string `json xml:"server"`
}
```
problem see is, i, tool owner know format correct one user? output new format would mean assum applic built latest (i.e: `1.16`) go version. run older version, new format work break applications.
one say output old format work henc tool alway output old format backward compatibility. choos approach, use case arise. assum user _already_ use new format:
```go
type T struct {
	Server string `json xml:"server"`
}
```
user add new tag, tool output old format, suddenli chang someth user intend use:
```go
type T struct {
	Server string `json:"server" xml:"server" bson:"server"`
}
```
think approach use now. then, wonder make easier user use new syntax. feel like compromis need consid whether chang would caus disrupt futur lot servic might run old versions. look like tick bomb wait explod hope reconsid syntax due reason list here.
@fatih go languag version go.mod file for? can't use new style version â‰¥ 1.16, otherwis stick old one?
@uluyol use think thing believ that' true. go.mod file declar 1.16 still compil 1.15 lower.
go.mod file say `go 1.16`, mean file modul may use construct introduc languag version 1.16. person use go 1.15 earlier compil still attempt compil module. prohibited. error occur compiling, go tool report "note: modul requir go 1.16".
gener ok transform tool use go 1.16 languag construct `go 1.16` appear go.mod file.
fulli agre @ianlancetaylor; tool use go.mod languag version decision. case slightli trickier, older version go would fail use vet/test pars struct field tag, compil time, pretti sure struct field tag fulli pars compil time.
still think okay. modul declar go 1.16 languag version, downstream user insist use go 1.14 1.15, argu extra care softwar still work even builds. go program/modul build older version go mean work fine. fulli vetting/test older go version way sure.
> argu extra care softwar still work even build
clarify, however, think might end problem peopl instal go program via go get/instal follow readm instructions. peopl like go experts, might use go version came system, often older version. program instal works, would reason think program might work properly.
said, still think problem go build general; chang add anoth way end weird spot.
> error occur compiling, go tool report "note: modul requir go 1.16".
heurist work well languag chang break exist syntax, well chang like one chang behaviour result error use old compil version.
example, say third parti packag chang use feature, (still use go 1.15) updat use new version. code broken indic fact. `go vet` would pick up, uncommon peopl run `go vet` third-parti code (do often spew raft fals positives).
use older go compiler, common import modul declar newer go versions, newli creat modul declar current compil version even use new languag features, see happen instant red flag (aside: `go list -f '{{.path}} {{.goversion}}' -m all` _hard_ type, obviou either, want check this).
worri larger ecosystems, chang might end signific non-obvi broken emerg thing break production.
current see easi way around it.
> heurist work well languag chang break exist syntax, well chang like one chang behaviour result error use old compil version.
yes. discuss detail .
quit redefinition, new code gener runtim error pre-1.16 version standard library, right problemat gener compil time error.
think agre you: although said use new syntax sens permit go 1.16 later, full safeti suggest use new syntax go 1.15 earlier longer supported.
> quit redefinition, new code gener runtim error pre-1.16 version standard librari
see runtim error run code go 1.15,
seem like actual redefinition.
right. mistaken.
chang mention issue: `go/analysis/passes/structtag: recogn multipl key per tag`
chang mention issue: `cmd/vet: vendor x/tools, updat structtag vet check`
@ianlancetaylor sort confusion, decis includ chang go 1.16 even though inde redefinition?
read look like redefinit avoided:
> think feasibl safe approach permit languag redefinitions.
understand might except critic changes, featur realli fall category?
