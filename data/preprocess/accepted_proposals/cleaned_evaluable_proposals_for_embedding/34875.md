go/doc: add tomarkdown
recent gopl ad markdown output markdown comments, implement basic copi go/doc/comment.go replac thing markdown instead html.
go/doc flexibl would less copi paste. interfac use creat custom formatters. way packag need backward compat older go stdlib creat formatt use older version go. type implement copi past go/doc/comment.go(or vice versa).
will implement togeth port gopl markdown implement go/doc
/cc @dmitshur
hi, although function code interfac work situations. implement interfac old format markdown.
somebodi check open cl it? (not check code, general)
@jaicewizard: current freez part go releas cycl (see new featur accepted. would suggest send cl tree open go 1.14 released.
thank info, want start send cl without discuss interfac look like, set remind send one february.
sound good. think cl ready, fine send februari discuss occur review process. otherwise, mark issu propos spark convers (just add prefix "proposal: " issu title).
chang mention issue: `go/doc: make format comment flexibl use interface`
thank send change, @jaicewizard. help prototyp discuss consid change.
`go/doc` packag low level standard library. new api ad it, possibl chang due go 1 compat promise. result, potenti api addit need discuss agre first. (see issu #23864 exampl previou propos add new function `go/doc` package.)
may decid ad new function would better anoth packag (not standard library). depend whether expect propos api solv problem well today future, without need api changes. then, may less costli maintain copi code necessari packages.
/cc @griesem @agnivad per owners.
also see cl 72890 relat work. attempt split document render smaller flexibl build blocks. updat copi packag use render document pkg.go.dev, go open sourc (see #36747).
implement close ident old implement html (to help reduc ad mainten cost) allow flexibl implementations. implement basic given string context around string format whatev way would want to.
idea reduc copi go standard library, necessarili bring someth peopl alreadi use standard library.
understand need discuss first, open issue.
reason proposal. joe' cl proof enough need librari there. core idea look good me. hash nitti gritti new api propos accepted.
per comment cl, think interfac outlin cl complicated. pretti clear idea realist api look like accept propos (not way around).
mean interfac alreadi implement interfac outlin reason later api comment essenti list text blocks, headers, urls, idents, "raw"/cod block between.
interfac would give formatt abil block text whatev wants. also make pars easy, put extra burden formatter.
sorri imprecise. think new outlin interfac look great spend much time think it.
think interfac implement cl good actual put much time think it.
one benefit new interfac might immedi think abl type-assert formatt compat potenti new feature. adjust intern formatt capabilities. aka ad new featur breaking.
cl remov `totext` `tohtml` function `go/doc` api.
gener defin interfac go expos lot detail realli rather commit to.
fine fork modifi packag appropriate, need intern detail exposed.
would probabl make sens add tomarkdown alongsid totext tohtml.
would lot easier design api ad interfac (the api tohtml).
propos ad activ column propos project
review weekli propos review meetings.
â€” rsc propos review group
easi way get ast pars comment would better, imo. unexport block function mayb split paragraph head span text quotat url like. new format simpl pretti printer. would also make easi adjac thing like extract head build outline.
@jimmyfrasch issu ast interfac expand doc syntax (we talk ad list form point, example) pretty-print consum ast learn someth new.
stick narrow interfac totext, tohtml, tomarkdown, program use keep working.
let' see ad tomarkdown. retitl this. propos add
func tomarkdown(w io.writer, text string, word map[string]string)
signatur
func tohtml(w io.writer, text string, word map[string]string)
anyon object this?
would gopl (the motiv top comment above) abl use it?
/cc @dmitshur @julieqiu
> @jimmyfrasch issu ast interfac expand doc syntax (we talk ad list form point, example) pretty-print consum ast learn someth new.
> stick narrow interfac totext, tohtml, tomarkdown, program use keep working.
get motiv behind this. could argu chang syntax would go1 compatible, program might reli output function stay same. would say mean doc relat code `golang.org/x`, decis long gone, start use go even.
program realli want anoth output format, would say pars convert markdown output someth els problem sinc plenti markdown parsers. would help prevent copy-past go sourc code.
there' preced implement standard librari packag term vendor golang.org/x packages. case, list ad golang.org/x modul could made v2 anyon use narrow interfac go/doc would unaffect
ping @dmitshur @julieqiu confirm ad tomarkdown would help gopls.
(you one comment top assum use case.
sure whether gopl pkg.go.dev, say gopls.)
spoke @julieqiu this. memori triag back oct 2019 thought @dmitshur owner (think godoc go/doc maybe). retract question you.
see anyon object this, given central markdown today' dev environments, seem worth doing.
base discuss above, propos seem like **like accept**.
â€” rsc propos review group
> see anyon object this, given central markdown today' dev environments, seem worth doing.
humbl opinion, say someth favor "today" ad stdlib decis examin differ time unit. one point, xml favor, recent time, format (such markdown) becom favor. think reason conclud then, markdown could suffer fate.
said, use markdown frequently, enjoy syntax, skeptic ad export must support forev (or non 1.x becom reality, may never, given discussions)
@dividinglimits, folk stop use markdown point, what' harm keep unus `tomarkdown` function around standard library? simple, stabl format, implement cost mainten quit low, linker prune program call it.
see harm, set (or extend) preced someth favor now, good candid addition. concern line demarc fit profile, whether capabl helpful.
chang consensus, **accepted**. ðŸŽ‰
