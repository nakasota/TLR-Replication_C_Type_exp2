go/doc: drop //go:* comment extract doc
today write thing like:
//go:noinlin
// f whatev does.
func f()
instead natural:
// f whatev does.
//go:noinlin
func f()
latter produces:
$ go doc f
func f()
f whatev does. go:noinlin
//go: convention, let' fix go/doc leav automatically,
write thing natur way without clutter docs.
happi work.
/cc @griesem
chang mention issue: `go/ast: drop //direct comment doc.text`
implement change, reference.
ad minut first time week, seem head like accept base reaction far.
would also appli machine-read comment (not prefix `go:`)? run similar issu `golangci-lint`' `//nolint` comments.
> would also appli machine-read comment (not prefix go:)? run similar issu golangci-lint' //nolint comments.
think `go doc` awar of, handl syntax third-parti linters. problem might solvabl delet comment use `grep -v` ci pipelin instead exclud specif check want.
> think `go doc` awar of, handl syntax third-parti linters. problem might solvabl delet comment use `grep -v` ci pipelin instead exclud specif check want.
that' rudimentari way ignor linter messag scale. explicitli code common (tslint/eslint ignores, jetbrain' style ignores, others) mean version controllable, configur per-instance, avail editor (gopl staticcheck built in!), on. suggest chang ci system check linter messag fix gener document includ unwant comments. that'd backwards.
one thing say comment without space `//` experi usual machine-read ones, like go' `//go:generate`, golangci-lint' `//nolint`, staticcheck' `//lint:ignore`, counterfeiter' `//counterfeiter:generate`, more. perhap comment without space `//` becom convent instead. that'd differ proposal.
awar linter comment syntax, `//` comment lead space machine-readable, understood gener convent (although can't find document say much).
implement `//[^ ]` get ignored, comment without space omit them. even test //todo, //note, //bug, etc. there' one exampl output space // output.
right `//line ` (with trail space) `//go:`.
could replac `//go:` `//[a-z0-9]+:[a-z0-9]`.
tri that.
object either options?
ran follow mod cache:
```
$ rg -g '*.go' -I '^//[a-z0-9]+:[a-z0-9]' | sort -u
```
output:
everyth look good me. see fals posit (besid two `//0:` `//1:` comments, document comment).
think regex like enough. thing consid ad `_` `-` charact sets, add diff results, addit comment added, mayb big deal.
but, cach subset projects.
> could replac `//go:` `//[a-z0-9]+:[a-z0-9]`.
motiv replac "go" part `[a-z0-9]+`?
@dmitshur may direct commands. see exampl given here.
ideal would gone `^//[^ ]` `^//[a-z0-9]` someth broader, sinc e.g. `//nolint` (no colon) also use places, that' `cmd/compile` doc say directive. grep similar @zikaeroh' make seem like bad idea: plenti project seem start ordinari doc comment without space. (a coupl arbitrari exampl mod cache: glfw gomega.) like `//[a-z0-9]+:[a-z0-9]` compromise.
> sinc e.g. //nolint (no colon) also use place
yeah, that' unfortunate, though believ case put `//nolint` line declar instead, like:
```go
// SomeFunc does something.
func SomeFunc() { //nolint
    ...
}
```
believ least golangci-lint would accept that. sure past that.
> that' cmd/compil doc say directive.
shame `go/doc` omit "directive" style comment doc start, late that... prefer everyon put space `//` realli surpris mani without one. :slightly_frowning_face:
discuss respons question see objections.
base discussion, then, seem like **like accept**.
chang consensus, accepted.
isdirect check also handl `//export` comment (
@nd would mind open new issu that? thanks.
file #38785.
