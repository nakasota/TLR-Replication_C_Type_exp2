testing: chang -run regexp make / usual preced
`go test -run` flag use select multipl root test cases. exampl run 3 test match regex exactly:
```sh
go test -run '^(TestOne|TestTwo|TestThree)$'
```
far tell, logic handl subtest make imposs subtest cases. seem possibl run multipl root test cases, singl subtest case:
```sh
go test -run '^TestOne$|^TestTwo$|^TestThree$/^SubTestA$'
```
ad anyth `/` assum sub-sub test, match way.
thing tried, work:
**match `subtesta`, one `testthree`**
```
^(TestOne|TestTwo|TestThree)$/^SubTestA$
```
**doe match subtests**
parenthesi handl `splitregex`
```
(^TestOne$|^TestTwo$|^TestThree$/^SubTestA$)
```
would reason support `-run` flag? look match logic `src/testing` seem like may small change.
cc @mpvl
see discuss think `|` charact account (none test includ case one). can't see way make work split regex `/`.
mayb goal accomplish ad `[^/]*` non-anchor `/` regex? guess solv part it. sure parent test match regex subtest evaluated.
test packag must way figur whether top-level test match (and started), separ rest expression, that' split unparenthes slashes. chang ordinari preced concatenation-with-slash higher altern (|), probabl mistake. mayb fix split |s first.
is, shown
'^testone$|^testtwo$|^testthree$/^subtesta$'
implicitli
^(testone|testtwo|testthree)$/^subtesta$
there' way overrid implicit parens. split pipe first would essenti remov implicit parens.
will tri (split first pipes) start cycl see break anything. thoughts?
/cc @mpvl
break usag like this, intent run sever `testfoo` subtests?
```
go test -run 'TestFoo/First|Second'
```
sure behaviour chang reason.
... decid behaviour _is_ ok changed, record, still think thing would better pattern implicitli anchor (i often get bitten sever test run intend one test name
specifi prefix other forgotten add `$` qualifier).
anoth possibl fix issue, allow multipl `-run` flags?
example:
```
go test -run '^TestOne$' -run '^TestTwo$' -run '^TestThree$/^SubTestA$'
```
anoth abil like see abil _exclude_ test rather includ them, there' problemat test, that' anoth propos :)
new flag (`-run-regex` ?) accept regex modifi regex would one easi way solv it. understand desir keep number flag minimum, imagin option desirable.
allow `-run` flag repeat work backward compat way.
think split `|` could work, would requir paren ad values. assum parenthesi handl way now, `/` `|` within open left paren caus split.
`testfoo/first|second` would need written `testfoo/(first|second)`.
@rogpeppe, right chang mean syntax, `x/y|z` mean "`x/y` `z`" arguabl kind bug. alway write `x/(y|z)` get meaning, peopl probabl would alreadi (becaus that' say get mean plain text regexp match).
problem chang would solv `a/b|c/d` today mean `a/(b|c)/d`, contradict plain text regexp match, wors correction, way get "`a/b` `c/d`".
suggest solut - split pipe split slash - close respect text matches, make pipe oper looser bind implicit concaten around slash. want, paren alway added. pipe oper bind looser concatenation, instanc problem need address.
altern would go back exactli plain text semantics, ad rule match right slash allowed. would requir extra support regexp engin would still special, even differ special (for example, -run='^x$/^y$' would work anymore), inclin go road instead.
current syntax bit compromise, work well general, gener design might well stay. still seem like fix preced problem workaround. yes, chang mean certain corner case - design - chang way alway overridden paren (in contrast today).
anyon object make chang describ comment above?
base discuss above, seem like **like accept**
(for earli cycle, understand might need back out).
chang consensus, accepted.
work vscode-go, afaik current syntax make imposs run arbitrari set test sub tests. understand propos correctly, merged, `-run ^(a|b/c)$` would run base test sub test b/c. fix problem.
chang mention issue: `testing: increas altern precedence`
mayb misunderstanding, propos direct contradict regexp/syntax.cut behavior propos
@aclement thought too, think would work first cut `|` cut `/`
fwiw, chang caus exist test script silent omit test previous ran.
updat scripts, somewhat concern failur mode chang “silent reduct test coverage”.
@bcmill think rais higher releas notes? current mention "minor chang library."
think would realli help — thought check releas note all, pretti easi find paragraph behavior change.
@bcmill one thing consid propos way specifi exact list test run, regular express involved. would make straightfoward (for example) parallelis singl package' test across instances. seem that' origin poster after. could also add abil exclud certain test time. could perhap revert chang favour that. wdyt?
@rogpeppe, think that' mostli orthogon change.
seem question particular chang whether benefit make regexp semant better match users' intuit worth cost break exist script — accident intent — reli previou semantics.
think _would_ help might pars appli regexp ways, emit explicit warn (or fail test!) regexp would run addit test prior go version. would least make chang behavior easier identify.
