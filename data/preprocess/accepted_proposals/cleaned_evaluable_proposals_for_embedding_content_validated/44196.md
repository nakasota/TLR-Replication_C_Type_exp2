time: add time.unixmilli time.unixmicro (like time.unixnano)
would like implement function `time.unixmills()` return int64 milliseconds, like `time.unixnano()` return int64 nanoseconds.
today want get valu time millisecond need lot calculations, know languag function research implement function time package.
simpl function two const need easier understood.
simplest way found implement:
implement base rust `as_millis()`:
---
edited:
first, thank contribut discuss, problem contribut much discuss initi abl expos points. point discuss appar consensus.
format propos correctli agreed.
base discuss direct converters, gener consum probabl someth like that:
```go
func (t Time) UnixMilli() int64 {}
func (t Time) UnixMicro() int64 {}
func UnixMilli(msec int64) Time {}
func UnixMicro(usec int64) Time {}
```
previous consid reject #18935 #27782.
still think worth doing, though. (i think name would `unixmilli` match `unixnano`, `unixmills`.)
one small thing chang sinc #27782 ad `time.duration.milliseconds` (and `microseconds`) #28564. might lend bit weight toward `unixmilli`.
recapitul point made #27782 closed:
1. believ common need (at least work):
2. fact there' popular third-parti packag implement evid anyth good tast (left-pad go way):
@willyrgf, context need time calcul unix milliseconds?
#27782 close unawar compel need justifi ad api.
heard peopl say "we use work" noth widespread that.
look kind standard reason need exact format.
propos ad activ column propos project
review weekli propos review meetings.
â€” rsc propos review group
work, use millisecond protobuf messages, databases, log messages. can't recal usag `time.unixnano()` besid convert milliseconds. mani places, author debated/searched/reluctantli settl differ approaches, usual one of:
```golang
time.UnixNano() / int64(time.Millisecond)
time.UnixNano() / 1e6
```
confus new go develop ("am wrong? _must_ miss someth obvious.."), make normal straightforward code harder mental parse. ad dedic user-defin librari call solv problem satisfactory:
1. make code asymmetr (`time.unixmilli()` vs `millis.from(time.now())`)
2. requir develop discov package, call code review add automat lint
3. requir perpetu maintenance, call anoth comment relat maintain standard library. instead one set maintainers, n everi team world develop go.
pleas look packag wrote #27782.
pkg.go.dev report imports, github.com 865 clone 145 uniqu cloners.
use ms timestamp coupl php projects, never use nano except go convert mill8s.
javascript work milliseconds; e.g. `date.now()` `x = new date(); x.gettime()` return unix-tim milliseconds, well `new date(<number>)` expect milliseconds. signific javascript code-bas ever work made use millisecond date-seri (and timezone-independ time-comparison).
written go-program consider javascript-interactions, those, `time.unixnano() / 1e6` fairli common occurr (and sourc bug one use often enough rememb 1e3, 1e6 1e9...)
anoth api option
```go
func (Time) SinceUnix() time.Duration
```
better name welcome.
could write `t.sinceunix().milliseconds()`.
`t.sinceunix().seconds()` `t.sinceunix().nanoseconds()`, matter.
name ideas:
* `sinceepoch`
* `sinceunixepoch`
* `unixduration` (via @benhoyt)
thank everyon suggestions, idea questions. edit propos present complet propos argument suggetions, idea question sent here.
`t.sub(time.unix(0,0)).milliseconds()`. api chang required.
@josharian definit prefer suggestion, though name suggest would `unixduration`, `t.unixduration().milliseconds()`. would nice `unix` return durat begin with, would need one, oh well.
@randall77' suggest bad, though bit awkward.
method comput unix time millisecond nanosecond int64 value, includ valu type duration, limit support time rang approxim 1677-09-21 2262-04-11, much smaller javascript rang "approxim -273,790 273,790 year rel 1970.". see
sinc javascript driver millisecond requirement, think taken consideration. full int64 millisecond unix time rang support addit function unixmilli comput time valu unix time millisecond required.
"look kind standard reason".
convert timestamp millisecond sinc epoch (and vice versa) talk extern api (i'm sure more, happen use, show grep manual conversion):
* apple' appstor
* amplitude'
* airtabl
* bigqueri
* gmail
alway think "represent timestamp" "the durat sinc 1970" (though realiz definit equivalent), frame `unixmillis` make sens intermedi durat conversion.
also love symmetr method creat new time timestamp format way, convers out-of format similarli easy.
```
// UnixMilli returns t as a Unix time, the number of milliseconds elapsed since January 1, 1970 UTC
func (t Time) UnixMilli() int64 {
  return t.UnixNano() / 1e6
}
// UnixMilli returns the local Time corresponding to the given Unix time m milliseconds since January 1, 1970 UTC. 
func UnixMilli(m int64) Time {
  return Unix(0, m * 1e6)
}
```
similar @cespare, here, use `(*time) unixnano` `time.unix` codebas context sourc destin actual milliseconds; cours search found incorrect convers slip past code review: `time.unix(m/1000, (m%1000)*1000)`.
(everi time implement this, end stackoverflow post ( bunch debat whether accept answer actual correct, happen work given way go setup today...)
> cours search found incorrect convers slip past code review
confirm done same, includ look first .
love @randall77 's solut think come so. perform reasons, might also nice avoid float divis naiv `time.unixnano() / int64(time.millisecond)` approach.
@conradirwin thank references, thank @msiebuhr point javascript.
although clever way without, seem like add unixmilli.
mayb unixmicro php fill strang gap unixmilli unixnano.
`duration.milliseconds` `duration.microseconds` spell full, `time.unixmilli` `time.unixmicro` abbreviated?
better wors follow exist exampl `unixnano`.
fair enough -- notic there' also `stampmilli` `stampmicro`. right, make sens follow pattern "closest" (the `time` methods).
there' stuff `time` second nanosecond variant only. also start grow millisecond-flavor neoplasms?
clutter packag doc everyon get rid singl divis (some) user code.
chang mention issue: `time: add unixmilli unixmicro`
cl sent origin includ constructor time.unixmilli time.unixmicro removed.
still, seem incomplet convert one direction. use format, probabl gener consum it.
call it?
origin gave time.unix two argument avoid separ time.unix time.unixnano.
think still get away without time.unixnano.
perhap add time.unixmilli time.unixmicro, unix (doe second + nanos), unixmilli, unixmicro.
anyon object this?
base discuss above, propos seem like **like accept**.
â€” rsc propos review group
updat propos base discuss took place here.
tini detail regard updat proposal: pleas use Âµsec least usec microsecond. former use proper si unit prefix latter typic abbrevi program languag restrict ascii. exampl struct timev <sys/time.h> field tv_usec. name mcsec appear least quit unusual.
fact good name, think wrote this.
adjusted.
chang consensus, **accepted**. ðŸŽ‰
