doc: updat go memori model
june 2021 post seri articl memori models, end articl chang thought make go memori model. see especi
open github discuss discuss changes; see #47141.
base discussion, propos follow concret chang memori model:
- document go' overal approach.
- document multiword race caus crashes.
- document happens-befor runtime.setfinalizer.
- document (or link to) happens-befor sync types.
- document happens-befor sync/atomic, match c++ sequenti consist atom (and java, javascript, rust, swift, c, ...)
- document disallow compil optimizations.
exact detail view pend cl prepar concreteness, particular cl 381315 (memori model) cl 381316 (librari docs).
file separ propos - #50860 - anoth item aros discussion, name ad type atom valu sync/atomic.
chang mention issue: `doc: updat go memori model`
chang mention issue: `runtime, sync, sync/atomic: document happens-befor guarantees`
propos ad activ column propos project
review weekli propos review meetings.
â€” rsc propos review group
base feedback arm, revis exampl toward end memori model remov implic hoist read (provid fault) condit alway problematic.
anyon object accept proposal?
sorri leav comment cl see comment to. continu believ seriou problem approach, offer discuss.
thank @hboehm. take offer.
updat issu here, good discuss @hboehm.
hans' primari object new text claim go provid drf-sc rule given current draft strong enough support claim.
goal current rule tri restrict compil allow do, avoid clever like reload valu memori rather spill privat locat like stack. gener goal say user "don't depend behavior raci programs" time say compil writer (in contrast c/c++) "don't assum program race-fre / make race worse". is, might call "drf-sc avoid catch fire".
han believ user part, possibl reduc c++ drf-sc model someth reason go (and much simpler c++, sinc relax atomics), compil writer part deliv inform implement advice. go look approach.
han also point particular section titl "a new class out-of-thin-air results", certainli worrying. current allow relax atom loads/stores, start think operations, would need grappl program allow do.
updat text base discuss @hboehm earli april. main chang start "here semant race-fre programs" section, explicitli align c, c++, java, javascript, rust, swift, on. old text limit damag possibl raci program follow inform implement restriction.
head, new text say alway want say no-op. formally, actual say right thing race-fre program prove provid sequenti consist semant (drf-sc).
diff
base discuss above, propos seem like **like accept**.
â€” rsc propos review group
chang consensus, **accepted**. ðŸŽ‰
