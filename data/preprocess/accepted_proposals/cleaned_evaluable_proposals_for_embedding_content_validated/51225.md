cmd/compile: requir build system specifi -importcfg
originally, cmd/compil implement lot logic resolv import paths, find instal packages, etc. internally. nowadays, handl cmd/go instead, invok cmd/compil -importcfg option. however, lot histor code flag still exist within cmd/compile, obviou use case still matter.
propos requir build system want predict behavior cmd/compil must use -importcfg. -importcfg used, cmd/compile' handl import path unspecifi subject chang discret compil team.
practice, anticip fallback logic chang much today (to avoid break test/run.go compil dev workflows). current code grown convolut question code paths, would easier cleanup could constrain set support options.
specif chang proposing?
think practic alreadi true non-importcfg behavior undefined. happi say that.
sure accomplish say that. seem like want this, need put teeth behind it, make compil fail without -importcfg. break peopl work compil run thing like â€œgo tool compileâ€ hand, seem like mistake. (we could adjust test/run.go, by-hand stuff still worri little.)
propos ad activ column propos project
review weekli propos review meetings.
â€” rsc propos review group
like drop support `-d`, `-i`, `-importmap`. mayb `-installsuffix` too. doubl check, believ flag need `-importcfg` used.
note test/run.go pass `-d` `-i` cmd/compile,
might hard get rid `-installsuffix` sinc also option `go build`. perhap nobodi use it.
> note test/run.go pass -d -i cmd/compile,
ack, expect could reason chang use `-importcfg` instead.
> might hard get rid -installsuffix sinc also option go build.
similarly, expect cmd/go implement top `-importcfg` `-o`, already. (i'd expect build cach effect requir cmd/go actually, mayb not.)
assum bazel use -importcfg flags, seem fine. enough say deprecated: either noth remov them. want updat all.bash depend them?
absenc real data, could tri leav implement place go 1.19 add easili revert line fail compil use flag see rc goes.
chang mention issue: `cmd/compile: remov -importmap flag`
chang mention issue: `cmd/{compile,link}: remov -installsuffix flags`
two cl trivial remov cmd/compile' -importmap -installsuffix flag without all.bash breakage, think pretti minim invasive. (cmd/link -installsuffix flag too, seem actual need something; outsid scope concern though.)
remov -d -i requir minimum invas chang variou tests. wari attempt go 1.19, think doabl go 1.20.
cl look good. let' tri go 1.19 - easili reverted.
base discuss above, propos seem like **like accept**.
â€” rsc propos review group
chang mention issue: `doc: mention remov cmd/compile' -importmap -installsuffix flags`
chang consensus, **accepted**. ðŸŽ‰
