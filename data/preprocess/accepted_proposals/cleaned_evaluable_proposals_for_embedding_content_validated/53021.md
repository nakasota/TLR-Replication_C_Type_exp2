crypto/subtle: add xorbyt
function `crypto/cipher.xorbytes` perform well defined, simpl oper common cryptograph algorithm network protocols. stdlib contain number optimis assembl version function.
pion libraries, particular, contain version `xorbytes`, far optimis go version. `xorbytes` exported, would yield immedi perform boost pion, possibl cryptograph network libraries.
altern would put function `x/`, need remain compatible. however, sinc oper function perform simpl well-defined, cost export stdlib seem fairli minor me.
cc @golang/secur
previous discuss declin #30553. sound like x/ ok one work(?).
see also #42010 #35381 #28465. thereâ€™ lot demand.
would go exported? crypto/subtle? (it' definit case xor' two byte slice togeth better know doing.)
seem special-purpos packag bytes. use crypto?
/cc @golang/secur
propos ad activ column propos project
review weekli propos review meetings.
â€” rsc propos review group
> use crypto?
thing think raid/ecc unusu codecs. practice, everi request seen go world cryptography.
@racin implement function entangl codes. arguabl use-cas commonli use code technique, least one data point `xorbytes` use cryptography.
figur go, seem ok principl add someth standard library.
could also recogn pattern optim compil without visibl api. that' alreadi for:
```
for i := range a {
    a[i] = 0
}
```
turn memset. could also recogn
```
for i := range a {
    c[i] = a[i] ^ b[i]
}
```
turn librari call.
also kind thing encoding/binary' variou integ assembly/disassembl routines.
suppos figur right pattern is, mayb that' easier design new api.
> could also recogn pattern optim compil without
> visibl api.
perhap minor here, prefer librari function
magic pattern. find easier call well-docu librari function
check gener assembl order make sure
magic pattern matched.
ok ad librari figur good place.
add bytes, assum add strings.
allocate, would take dst, differ thing bytes.
go new packag super-fast oper byte slices,
relat oper might go package?
mayb zero byte slice?
copi 'copy' builtin.
compil recogn seem bad compar this.
> go new packag super-fast oper byte slices,
relat oper might go package?
@mele mention use `xorbytes` previous snarl.
however, seem subtl differ `xorbytes` crypto/cipher, case two input byte slice differ length.
case, kept overflow byte longest one, whilst latter implement overflow input seem discarded.
one advantag librari function implement bar lower. compil optim must ensur preserv semant precisely, includ case panic partway (exactli memori write occur, exactli panic occurs, line). could end make differ short byte slices, overhead matters.
hand, compil optim appli xor anyth (name uint8s, uint64s, etc.), seem pretti nice.
2c would start compil optimization, unless there' reason need constant time, case (a) clearli belong crypto/subtl (b) cannot done compil optimizations.
follow use `xorbytes` packag mine.
@racin bring good point, bit also. get exported/link make known comment/doc it.
agre @josharian, 2c would add `crypto/subtle` (it simpl linkname) would fulfil need. compil optim scenario, seem complicated, could implement later ad benefit.
given `xorbytes` bitwis xor, could also consid `math/bits`. none current api work slices, conceptu think fit better `bytes`, restrict us cryptographi either.
> could also consid `math/bits`
could also consid seed futur simd package.
/me duck
> go new packag super-fast oper byte slices, relat oper might go package?
think pretti much one-off â€” think mani oper simpl imposs avoid. let' dump `bytes`, done it. alway creat comprehens packag function appar (and deprec version `bytes`).
seem like choic are:
crypto/subtle.xorbyt
math/bits.xorbyt
bytes.xor
peopl want crypto, seem like crypto/subtl probabl right place start. seem gener enough bytes, fit rest oper math/bit (none slices).
anyon object crypto/subtle.xorbytes?
agre `crypto/subtle`. mayb `subtle.xorbytes` `subtle.xor` though?
spell xor instead xor match math/big.
matter much seem like consistent.
anyon object crypto/subtle.xorbytes?
(didn't plain xor mayb thing need subtl xor' too.)
hand, ian point crypto/ciph xorkeystream, mayb xorbyt better match thing crypto. happi too.
fix titl match comment last week.
base discuss above, propos seem like **like accept**.
â€” rsc propos review group
chang consensus, **accepted**. ðŸŽ‰
