=== Fetching Proposal: MDU6SXNzdWU5OTE0MjEzNjE= ===
Issue URL: https://github.com/golang/go/issues/48258

==== [Issue Title] ====
cmd/go: add a `go work sync` command

==== [Issue Body] ====
This issue proposes amending the Workspaces Proposal (#45713) to add a new `go mod syncwork` command. 

`go mod syncwork` would compute the buildlist from the workspace modules, and then sync it back to the workspace module `go.mod` files, setting the versions of any non-workspace modules to the versions in the build list (perhaps also tidying the files afterward). This ensures that the workspace modules use the same set of non-workspace dependencies when they're built outside the workspace.

A version of this was suggested by @jayconrod on an [issue comment](https://github.com/golang/go/issues/45713#issuecomment-908746458) on the Workspaces proposal.

cc @bcmills @ianthehat 

==== [Comments] ====

--- Comment #1 by rsc ---

This proposal has been added to the [active column](https://golang.org/s/proposal-status#active) of the proposals project
and will now be reviewed at the weekly proposal review meetings.
â€” rsc for the proposal review group


--- Comment #2 by rsc ---

Based on the discussion above, this proposal seems like a **[likely accept](https://golang.org/s/proposal-status#likely-accept)**.
â€” rsc for the proposal review group


--- Comment #3 by mvdan ---
With my module author hat on, I definitely agree that this is a problem in need of solving - if one is developing and testing on a workspace, one can easily forget to check if each module individually still works as expected, without the workspace context.

I have a slight feeling that this feature is backwards, though. For example, right now I was using a `go.work` file to develop three libraries at once. When I'm done with my change, I want to make sure that each library still works as expected without `go.work`, and bump some dependencies for each module otherwise.

I don't think I would want to use `go mod syncwork` for this use case, because that feels like a very big hammer. For a library, I think it's generally saner to only update dependencies as needed. If I have libraries A and B, and A pulls a version of dependency C that's much newer than the version of C that B requires, I probably wouldn't want users of B to be forced into using the newest C unless B actually requires that - be it for a feature, or for a necessary bugfix.

I'm not sure what I would want to use instead, in terms of automation. Presumably, the right way of double checking that the library modules still work outside the workspace is a manual process. Maybe that checking, without editing any go.mod files, could be automated in cmd/go.

--- Comment #4 by hherman1 ---
Nit: given https://golang.org/issue/48256 shouldnâ€™t this be go work sync?

--- Comment #5 by rsc ---

No change in consensus, so **[accepted](https://golang.org/s/proposal-status#accepted)**. ðŸŽ‰
This issue now tracks the work of implementing the proposal.
â€” rsc for the proposal review group


--- Comment #6 by matloob ---
This is done.
