=== Fetching Proposal: MDU6SXNzdWU3MjU4NjIzNjE= ===
Issue URL: https://github.com/golang/go/issues/42098

==== [Issue Title] ====
syscall: add SysProcAttr.NoInheritHandles on Windows

==== [Issue Body] ====
This is a proposal for the API change in the existing CL https://golang.org/cl/261917.

The proposal is to add a new field `DontInheritHandles` to `syscall.SysProcAttr` on Windows.  Setting this field will cause handles to not be inherited when creating a child process.

The negative field name is unfortunate but it's hard to see how to avoid it while preserving the desired semantics of the zero value of `SysProcAttr`.

==== [Comments] ====

--- Comment #1 by JohanKnutzen ---
**A bit of background to this CL**

Currently, [CreateProcess/CreateProcessAsUser](https://github.com/golang/go/blob/b04eb73a6891e81e2e611ee93b3aa8c4769d5967/src/syscall/exec_windows.go#L344) is called with bInheritHandles set to true.

In my use case on Windows, I have a service running in session 0 that spawns a process in another session.

As per the documentation here:
https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa

"Terminal Services:  You cannot inherit handles across sessions. Additionally, if this parameter is TRUE, you must create the process in the same session as the caller."

--- Comment #2 by rsc ---
We don't have any fields beginning with Dont, which is a bit difficult because of the missing apostrophe, among other things.
But we do have a bunch of fields and other names that begin with the word "No".
So maybe NoInheritHandles would be better.
(It can't be InheritHandles because we want inherit to be the default, but the default will be the zero value for this struct field.)

With NoInheritHandles, this seems fine to me.


--- Comment #3 by rsc ---
Does anyone object to this change?


--- Comment #4 by JohanKnutzen ---
Thanks @rsc 

I've updated the CL to rename DontInheritHandles->NoInheritHandles

--- Comment #5 by gopherbot ---
Change https://golang.org/cl/261917 mentions this issue: `syscall: expose bInheritHandles of CreateProcess`

--- Comment #6 by alexbrainman ---
DontInheritHandles->NoInheritHandles SGTM.

Thank you.

Alex

--- Comment #7 by rsc ---
Based on the discussion above, this seems like a **likely accept**.


--- Comment #8 by rsc ---
No change in consensus, so accepted.


--- Comment #9 by alexbrainman ---
> No change in consensus, so accepted.

@rsc does that mean we can submit

https://go-review.googlesource.com/c/go/+/261917/

?

Thank you.

Alex

--- Comment #10 by ianlancetaylor ---
Yes.
